---
export const prerender = false;

import { supabase } from "../lib/supabase";

export const actions = {
  createUser: async ({ request }) => {
    const formData = await request.formData();
    const email = formData.get("email");

    if (!email) {
      return { success: false, message: "Email requerido" };
    }

    const { error } = await supabase
      .from("users")
      .insert({ email });

    if (error) {
      return { success: false, message: error.message };
    }

    return { success: true };
  }
};
---
<form method="POST" action={Astro.actions.createUser}>
  <input
    type="email"
    name="email"
    placeholder="Correo"
    required
  />
  <button type="submit">Enviar</button>
</form>
